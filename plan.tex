\documentclass[10pt,twocolumn,pdftex]{article}
\usepackage[margin=1in]{geometry}
\usepackage{comment}
\usepackage{graphicx}
\usepackage{url}
\usepackage[pdftex,colorlinks=true,citecolor=black,filecolor=black,%
            linkcolor=black,urlcolor=black]{hyperref}
\usepackage{times}
%\usepackage{listings}
%\usepackage{fancyvrb}
%\usepackage{amsmath}
%\usepackage{amsthm}
%\usepackage{amssymb}

%\lstset{ % for our code environment
%    language={},
%    basicstyle=\ttfamily}
%\let\code\lstinline

\title{CSCI 455: Analysis Plan}
\author{AJ Arnold, Matthew Berthoud, Justin Cresent, Ada Rigsby\\
\url{{ajarnold, mwberthoud, jacresent, acrigsby}@wm.edu}}
\date{}

% Simple macro to help with research questions
\newcounter{rqcounter}
\setcounter{rqcounter}{0}
% Usage: \newrq{label}{question}
\newcommand{\newrq}[2]{\noindent\refstepcounter{rqcounter}\textbf{RQ\arabic{rqcounter}:} {\em #2}\label{#1}}
% Usage: \rqref{label}
\newcommand{\rqref}[1]{\textbf{RQ\ref{#1}}}


\begin{document}
\maketitle

\section{Research Questions}

    \newrq{rq:req_perm}{Do apps use all of the permissions they request?}

    \newrq{rq:combo_perm}{Are any of the following dangerous permission combinations included? 

        \texttt{RECORD\_AUDIO \& INTERNET} (eavesdropping), 

        \texttt{ACCESS\_FINE\_LOCATION \& RECEIVE\_BOOT\_COMPLETED} (tracking), 

        \texttt{CAMERA \& INTERNET} (stalking),

        \texttt{SEND\_SMS \& WRITE\_SMS} (use phone as spam bot)

    }

    \newrq{rq:cert_ssl}{Do apps verify certifications incorrectly (Incorrect overrides of trust managers or error handlers methods)?} 

    \newrq{rq:host_ssl}{Do apps use improper Hostname verification?}

    \newrq{rq:deprecated_ssl}{Are apps using deprecated or vulnerable SSL protocols?}

    \newrq{rq:strip_ssl}{Do apps have mixed SSL use/are vulnerable to SSL Stripping attacks?}

    \newrq{rq:intents_interf}{Are sensitive data or mutable objects used in any implicit intents?}

    \newrq{rq:webview_interf}{Is trusted content loaded within any webviews? If displaying user-provided content, is data loaded into webviews sanitized?}

    \newrq{rq:js_interf}{Are applications that use webviews and \texttt{addJavascriptInterface()} correctly using the \texttt{@JavascriptInterface} annotation?}


\section{Hypotheses}

    In order to detect instances of permission misuse, SSL API misuse, and interface vulnerabilities, we will use static code analysis through scripting to identify these common developer oversights that put apps at risk.

\section{Evaluation Plan}


\subsection{Permissions Misuse Experiment}

    This experiment tests whether apps utilize all of the permissions they request, whether different dangerous permission combinations are implemented, and whether users are prompted and explicitly give their consent to every permission used.

    \subsubsection{Experimental Setup}
    We will scrape the MediaStore documentation for what permissions are associated with what constants (eg. CAMERA permission with ACTION\_IMAGE\_CAPTURE). After populating this dictionary, we will check to make sure that for every permission there is a corresponding constant found in the code, indicating that the permission has been used with MediaStore.

    We will use simple string searches in the Manifest to look for these permission combinations. 

    We will check for lines with .requestPermissions and then the name of each permission, to verify that the correct requests are being made for each permission.

    \subsubsection{Expected Results}

    Criteria for success include:
    a MediaStore API call exists for all permissions requested, 
    no dangerous combinations of permissions are found, and
    a requestPermissions call exists for every permission used within the application.

    False positives would be encountered if
    a dangerous combination is used, but there is no misuse of data, and if both/all permissions in the combination are necessary to the app’s core functionality, or 
    non-MediaStore APIs are used with proper permissions.


\subsection{Trust Managers and Error Handlers Experiment}
    This experiment is to test whether an app overrides a built in trust manager or error handler to forgo either method's intended purposes of correct verification of certificates. 

    \subsubsection{Experimental Setup}
    Will do simple string searches by parsing class files to see if trust manager or error handler methods are overridden.
    
    Will then view what is contained within the newly defined method. 

    \subsubsection{Expected Results}
    The experiment will succeed if the app contains no overridden trust manager or error handler methods when using SSL APIs, or if the application's overridden trust manager or error handler correctly handles certificates.

    We will see some false positives if there are overridden methods that incorrectly handle certificates (eg. such as simply proceeding rather than doing checks).


\subsection{addJavascriptInterface Experiment}
This experiment tests whether or not the application is being exposed to potentially dangerous outside sources depending on if the application uses a webview.

    \subsubsection{Experimental Setup}
    Source code will be parsed for the use of addJavascriptInterface(), and if successfully found, the use of the @JavascriptInterface annotation.

    \subsubsection{Expected Results}
    The experiment will succeed if the app contains no use of addJavascriptInterface, and if it uses addJavascriptInterface to only allow methods marked with it to be accessed by Javascript.

    There will be false positives if the app includes addJavascriptInterface without any @JavascriptInterface annotations, however it is being used in a safe manner.


\subsection{Mixed use SSL Experiment}
This experiment tests whether an app uses SSL on and off. Ex: Switching between HTTP and HTTPS.

    \subsubsection{Experimental Setup}
    For this test, will parse through the class files to see instances of using libraries such as “HttpURLConnection” and check to make sure all are configured to use https consistently.

    \subsubsection{Expected Results}
    The app will succeed if it consistently (all cases) uses SSL when it communicates with http (uses https).

    There may be false positives if an app makes an http request (not https) to a local server within a secure and controlled environment. While best practice is to use https, due to the nature of where this request was made, we can say that it is not a violation.


\subsection{AllowAllHostnameVerifier Experiment}
This experiment is to test whether an app uses the string AllowAllHostnameVerifier to allow all hostnames.

    \subsubsection{Experimental Setup}
    Will parse class files to see if this line is used.

    \subsubsection{Expected Results}
    The experiment will succeed if the app contains no use of AllowAllHostnameVerifier. 

    There will be no false positives unless this exact string is used randomly in the program.

\bibliographystyle{abbrv}
\bibliography{papers}

\end{document}


